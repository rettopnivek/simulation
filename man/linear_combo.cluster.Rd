% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/R01-linear_combination_functions.R
\name{linear_combo.cluster}
\alias{linear_combo.cluster}
\title{Linear Combination of Design Matrix and Coefficients for Clusters}
\usage{
linear_combo.cluster(etas, index, X)
}
\arguments{
\item{etas}{A S x K matrix of coefficients.}

\item{index}{A vector of N integers from 1 to S used to
expand the matrix \code{etas} to match in number of
rows to the design matrix \code{X}.}

\item{X}{A N x K design matrix.}
}
\value{
A vector of N values.
}
\description{
Given S clusters, N observations, and K variables,
computes the linear combination of K coefficients and
the relevant subset of the design matrix X for a given
cluster. Applicable for cluster-level coefficients
(often called random effects).
}
\examples{
index <- c( 1, 1, 2, 2, 3, 3 )
X <- cbind( 1, rep( 0:1, 3) )
etas <- MASS::mvrnorm( 3, rep( 0, 2 ), diag(2) )
etas |> linear_combo.cluster( index, X )

}
